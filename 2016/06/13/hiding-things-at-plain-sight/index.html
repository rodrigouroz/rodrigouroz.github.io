<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Take a look at this picture from Amsterdam.

What do you see?
I see a beautiful canal view with a bridge at the bottom on a Spring day (I knew it was ">
    

    <!--Author-->
    
        <meta name="author" content="Rodrigo Uroz">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Hiding things at plain sight"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="null" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Awaiting the Singularity"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    
        <meta property="og:image" content="https://rodrigouroz.github.ioundefined"/>
    

        <meta name="twitter:card" content="summary" />
    
        <meta name="twitter:site" content="rodrigouroz>" />
    

    <!-- Title -->
    
    <title>Hiding things at plain sight - Awaiting the Singularity</title>

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-79253721-1', 'auto');
        ga('send', 'pageview');

    </script>



</head>

<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Awaiting the Singularity</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/about">
                            
                                About
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/rodrigouroz">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/img/home.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Hiding things at plain sight</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        June 13th 2016
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/cryptography/">#cryptography</a> <a href="/tags/steganography/">#steganography</a> <a href="/tags/node-js/">#node.js</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                        

<a href="/categories/Software/">Software</a>

                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>Take a look at this picture from Amsterdam.</p>
<img src="/2016/06/13/hiding-things-at-plain-sight/amsterdam.png" alt="Amsterdam" title="Amsterdam">
<p>What do you see?</p>
<p>I see a beautiful canal view with a bridge at the bottom on a Spring day (I knew it was Spring when I shot it).</p>
<p>Do you see anything else? Something that don’t belong to the picture, something that shouldn’t be there…</p>
<p>No, me neither. We don’t see it because it’s not meant to be seen, it’s concealed in the image.</p>
<p>This was brilliantly put a long time ago:</p>
<blockquote><p>“What if the best way to hide something is at plain sight, where no one would suspect?”</p>
<footer><strong>Edgar Alan Poe</strong><cite>The Purloined Letter</cite></footer></blockquote>
<h2 id="History"><a href="#History" class="headerlink" title="History"></a>History</h2><p>Yeah, like I’ll try to outperform <em>Wikipedia</em>. Check <a href="https://en.wikipedia.org/wiki/Steganography" target="_blank" rel="external">Steganography</a></p>
<h2 id="Technique"><a href="#Technique" class="headerlink" title="Technique"></a>Technique</h2><p>The most common form of Steganography is called LSB for <em>Least Significant Bit</em>.</p>
<p>This uses the fact that a slight change in a pixel’s color is undetectable by the human eye.</p>
<p>Check for instance the samples below.</p>
<h3 id="Sample-1"><a href="#Sample-1" class="headerlink" title="Sample 1"></a>Sample 1</h3><img src="/2016/06/13/hiding-things-at-plain-sight/sample-1.png" alt="Sample 1" title="Sample 1">
<h3 id="Sample-2"><a href="#Sample-2" class="headerlink" title="Sample 2"></a>Sample 2</h3><img src="/2016/06/13/hiding-things-at-plain-sight/sample-2.png" alt="Sample 2" title="Sample 2">
<p>Can you spot the difference?</p>
<p>You don’t believe there’s a difference at all? Use a color meter to check it.</p>
<p>Both images are in full color. The first sample is Red = 108, Green = 118, Blue = 154. The second sample is Red = 109, Green = 119, Blue = 155.</p>
<p>As you can see in the second sample every Least Significant Bit is modified. This is the maximum change you can perform in a single pixel (changing every color component). If we change 1 bit per byte then we’re changing 1/8 of the file, or 12,5% of it.</p>
<p>If you can’t tell the difference at this scale (a 600 x 450 pixels image) imagine realizing that a single pixel has been modified.</p>
<p>So if this is undetectable then perhaps we can use this slight change in our favor…</p>
<h2 id="Algorithm"><a href="#Algorithm" class="headerlink" title="Algorithm"></a>Algorithm</h2><p>Here I describe the basics of the algorithm used to hide the image (and thus to recover it).</p>
<p>The input image (the host) must be in RGB format. Each pixel is defined by the colors Red, Green and Blue. Therefore each pixel needs 3 bytes.</p>
<p>We said we will use the least significant bit for each byte, so for every 3 pixels we have 9 bits available (3 pixels times 3 bytes per pixel gives us 9 bytes, we get a bit of each of those 9 bytes). We can use the first 8 bits to embed a single byte from the data we’re hiding and the last bit can be used to signal the end of the buffer. If the 9th. bit is 0 that means it’s the end of the buffer, otherwise we keep reading until a 0 is found. This allows us to embed several different sections of data in the same image.</p>
<p>To put it in another way, every 8th. bit of the file is a bit of the concealed buffer of data. There are two sections in this algorithm, the first section is the filename and the second section is the file data.</p>
<p>Starting at first pixel the name of the file being hidden is stored. Then after the name (when the algorithm detects an end of the section as described above) the actual data of the file is stored, byte per byte.</p>
<p>To recover the file then an application should first read the file name, and then the file data. Once finished it can create a file with the name obtained and write each retrieved byte.</p>
<p>The idea behind steganography is that you can hide things where it’s not evident that something is concealed. Unfortunately this common mechanism is widely known and studied and there are several countermeasures, based mostly in statistical analysis and histograms of pixel color distribution (because this technique is not symmetric, you can investigate <em>LSB Matching</em> for a fix to this problem).</p>
<p>To overcome this you can encrypt the data before embedding it in the file which will make obtaining the original file even harder. This file is not encrypted but the tool outlined at the end of the article supports encryption by providing a password.</p>
<p>So with all this information you should be able to find the hidden file. It could be a good opportunity to test bitwise operators and operations in your favorite language.</p>
<p>If you want to discover the hidden file and don’t want to build an application to do it you can use a simple tool I built for this post: <a href="https://www.npmjs.com/package/steganography" title="Steganography command line tool" target="_blank" rel="external">Steganography command line tool</a></p>
<p>Just install the tool and do</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&gt; steganography dig-up amsterdam.png .</span><br></pre></td></tr></table></figure>
<p>This will extract the embedded file in the current folder.</p>
<hr>
<p>I’d love to hear your comments. If you have found the hidden file, please let me know in a comment but don’t spoil other users ;-)</p>
<p>For my next trick I will conceal the private key of a <a href="https://bitcoin.org" target="_blank" rel="external">Bitcoin</a> wallet with $100 in it. Are you up to the challenge? Stay tunned… </p>


                
                    <!-- Go to www.addthis.com/dashboard to customize your tools -->
                    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-575ef3d4ca1d6efa"></script>

                    <!-- Go to www.addthis.com/dashboard to customize your tools -->
                    <div class="addthis_sharing_toolbox"></div>
                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    
    <hr />
    <h3>Comments:</h3>
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>



                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                        <li>
                            <a href="https://twitter.com/rodrigouroz" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://www.facebook.com/rodrigouroz" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://github.com/rodrigouroz" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://www.linkedin.com/in/rodrigouroz" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="mailto:rodrigouroz@gmail.com" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-envelope-o fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    
                </ul>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap -->
<script src="/bootstrap/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdn.rawgit.com/noelboss/featherlight/1.3.5/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->

<script type="text/javascript">
    var disqus_shortname = 'rodrigouroz';

    (function(){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


</body>

</html>